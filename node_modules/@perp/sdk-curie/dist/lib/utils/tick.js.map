{"version":3,"file":"tick.js","sources":["../../../src/utils/tick.ts"],"sourcesContent":["import Big from \"big.js\"\n\nexport const TICK_MAX = 887272\nexport const TICK_MIN = -TICK_MAX\n\nexport enum TickPriceMode {\n    LOWER = \"LOWER\",\n    UPPER = \"UPPER\",\n    NEAREST = \"NEAREST\",\n}\n\nexport function getMinTickByTickSpacing(tickSpacing: number): number {\n    return Math.ceil(TICK_MIN / tickSpacing) * tickSpacing\n}\n\nexport function getMaxTickByTickSpacing(tickSpacing: number): number {\n    return Math.floor(TICK_MAX / tickSpacing) * tickSpacing\n}\n\nfunction getBaseLog(x: number, y: number) {\n    return Math.log(y) / Math.log(x)\n}\n\nexport function tickToPrice(tick: number): Big {\n    return new Big(Math.pow(1.0001, tick))\n}\n\nexport function priceToTick(price: Big, tickSpacing: number): number {\n    const tick = getBaseLog(1.0001, +price)\n    const tickOnSpace = Math.round(tick / tickSpacing) * tickSpacing\n    return tickOnSpace > 0\n        ? Math.min(tickOnSpace, getMaxTickByTickSpacing(tickSpacing))\n        : Math.max(tickOnSpace, getMinTickByTickSpacing(tickSpacing))\n}\n\nexport function getTickFromPrice(price: Big, tickSpacing: number, mode = TickPriceMode.NEAREST): number {\n    const tickNearest = priceToTick(price, tickSpacing)\n    const tickPrev = tickNearest - tickSpacing\n    const tickNext = tickNearest + tickSpacing\n    const tickPriceNearest = tickToPrice(tickNearest)\n\n    switch (mode) {\n        case TickPriceMode.LOWER: {\n            return tickPriceNearest.lte(price) ? tickNearest : tickPrev\n        }\n        case TickPriceMode.UPPER: {\n            return tickPriceNearest.gte(price) ? tickNearest : tickNext\n        }\n        case TickPriceMode.NEAREST:\n        default: {\n            return tickNearest\n        }\n    }\n}\n"],"names":["TickPriceMode","getMinTickByTickSpacing","tickSpacing","Math","ceil","getMaxTickByTickSpacing","floor","tickToPrice","tick","Big","pow","priceToTick","price","x","y","log","tickOnSpace","round","min","max","mode","NEAREST","tickNearest","tickPrev","tickNext","tickPriceNearest","LOWER","lte","UPPER","gte"],"mappings":"uKAKA,IAAYA,EAMN,SAAUC,EAAwBC,GACpC,OAAOC,KAAKC,MATQ,OASQF,GAAeA,CAC/C,CAEM,SAAUG,EAAwBH,GACpC,OAAOC,KAAKG,MAdQ,OAcSJ,GAAeA,CAChD,CAMM,SAAUK,EAAYC,GACxB,OAAO,IAAIC,EAAG,QAACN,KAAKO,IAAI,OAAQF,GACpC,CAEgB,SAAAG,EAAYC,EAAYV,GACpC,MAAMM,GATUK,EASQ,OATGC,GASMF,EAR1BT,KAAKY,IAAID,GAAKX,KAAKY,IAAIF,IADlC,IAAoBA,EAAWC,EAU3B,MAAME,EAAcb,KAAKc,MAAMT,EAAON,GAAeA,EACrD,OAAOc,EAAc,EACfb,KAAKe,IAAIF,EAAaX,EAAwBH,IAC9CC,KAAKgB,IAAIH,EAAaf,EAAwBC,GACxD,CA5BYF,QAIXA,mBAAA,GAJWA,EAAAA,wBAAAA,QAAAA,cAIX,CAAA,IAHG,MAAA,QACAA,EAAA,MAAA,QACAA,EAAA,QAAA,2BANoB,yBACA,oGAgClB,SAA2BY,EAAYV,EAAqBkB,EAAOpB,QAAAA,cAAcqB,SACnF,MAAMC,EAAcX,EAAYC,EAAOV,GACjCqB,EAAWD,EAAcpB,EACzBsB,EAAWF,EAAcpB,EACzBuB,EAAmBlB,EAAYe,GAErC,OAAQF,GACJ,KAAKpB,QAAAA,cAAc0B,MACf,OAAOD,EAAiBE,IAAIf,GAASU,EAAcC,EAEvD,KAAKvB,QAAAA,cAAc4B,MACf,OAAOH,EAAiBI,IAAIjB,GAASU,EAAcE,EAEvD,KAAKxB,QAAAA,cAAcqB,QACnB,QACI,OAAOC,EAGnB"}