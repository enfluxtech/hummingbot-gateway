{"version":3,"file":"poll.js","sources":["../../../src/utils/poll.ts"],"sourcesContent":["import { CancelablePromise, CanceledPromiseError, makeCancelable } from \"./makeCancelablePromise\"\n\n// NOTE: this poll utils will cancel the previous promise if necessary\nexport function poll(func: Function, period: number) {\n    let previous: CancelablePromise\n    const interval = setInterval(async () => {\n        try {\n            if (previous) {\n                previous.cancel()\n            }\n            previous = makeCancelable(func())\n            await previous.promise\n        } catch (e) {\n            if (e instanceof CanceledPromiseError) {\n                return\n            }\n            throw e\n        }\n    }, period)\n\n    return {\n        cancel: () => clearInterval(interval),\n    }\n}\n"],"names":["poll","func","period","previous","interval","setInterval","async","cancel","makeCancelable","promise","e","CanceledPromiseError","clearInterval"],"mappings":"sFAGgB,SAAAA,EAAKC,EAAgBC,GACjC,IAAIC,EACJ,MAAMC,EAAWC,aAAYC,UACzB,IACQH,GACAA,EAASI,SAEbJ,EAAWK,EAAeP,WACpBE,EAASM,OAMlB,CALC,MAAOC,GACL,GAAIA,aAAaC,EACb,OAEJ,MAAMD,CACT,IACFR,GAEH,MAAO,CACHK,OAAQ,IAAMK,cAAcR,GAEpC"}